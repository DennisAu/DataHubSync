# DataBorder é¡¹ç›®é‡æ„æŠ¥å‘Š

## ğŸ“‹ é‡æ„æ¦‚è¿°

**æ—¶é—´**: 2025-02-04  
**åˆ†æ”¯**: feature/hub-refactor  
**ç›®æ ‡**: å°†Hubç«¯ä»£ç é‡æ„ä¸ºç‹¬ç«‹é¡¹ç›®

## ğŸ¯ é‡æ„ç›®æ ‡

1. **ä»£ç åˆ†ç¦»**: Hubç«¯å’Œå®¢æˆ·ç«¯å®Œå…¨ç‹¬ç«‹
2. **æ¨¡å—åŒ–**: æ¯ä¸ªé¡¹ç›®éƒ½æœ‰æ¸…æ™°çš„ç›®å½•ç»“æ„
3. **ç‹¬ç«‹éƒ¨ç½²**: ä¸¤ä¸ªé¡¹ç›®éƒ½å¯ä»¥ç‹¬ç«‹éƒ¨ç½²å’Œç»´æŠ¤
4. **é…ç½®åˆ†ç¦»**: å„è‡ªç‹¬ç«‹çš„é…ç½®æ–‡ä»¶

## ğŸ“ æ–°é¡¹ç›®ç»“æ„

```
DataBorder/
â”œâ”€â”€ hub/                      # Hubç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/                 # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ __init__.py      # åŒ…åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ main.py          # ä¸»å¯åŠ¨è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ http_server.py   # HTTPæœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ packager.py      # æ•°æ®æ‰“åŒ…å™¨
â”‚   â”‚   â”œâ”€â”€ state_manager.py # çŠ¶æ€ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ scheduler.py     # è°ƒåº¦å™¨
â”‚   â”‚   â”œâ”€â”€ freshness_checker.py # æ–°é²œåº¦æ£€æŸ¥å™¨
â”‚   â”‚   â””â”€â”€ calendar_reader.py # æ—¥å†è¯»å–å™¨
â”‚   â”œâ”€â”€ tests/               # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ scripts/             # éƒ¨ç½²è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ start_hub.sh    # å¯åŠ¨è„šæœ¬
â”‚   â”‚   â””â”€â”€ test_hub.sh     # æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ config.yaml     # Hubé…ç½®
â”‚   â”œâ”€â”€ docs/                # æ–‡æ¡£
â”‚   â”œâ”€â”€ requirements.txt     # Pythonä¾èµ–
â”‚   â””â”€â”€ README.md           # Hubç«¯æ–‡æ¡£
â”‚
â”œâ”€â”€ client/                  # å®¢æˆ·ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/                # æºä»£ç 
â”‚   â”œâ”€â”€ tests/              # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ scripts/            # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ docs/               # æ–‡æ¡£
â”‚   â”œâ”€â”€ requirements.txt    # Pythonä¾èµ–
â”‚   â””â”€â”€ README.md          # å®¢æˆ·ç«¯æ–‡æ¡£
â”‚
â”œâ”€â”€ requirements/            # å…±äº«éœ€æ±‚æ–‡æ¡£
â”œâ”€â”€ docs/                   # é¡¹ç›®çº§æ–‡æ¡£
â””â”€â”€ README.md              # é¡¹ç›®æ€»è§ˆ
```

## ğŸ”„ é‡æ„å˜æ›´

### 1. Hubç«¯å˜æ›´

#### æ–°å¢æ–‡ä»¶
- `hub/src/main.py` - ä¸»å¯åŠ¨è„šæœ¬
- `hub/scripts/start_hub.sh` - å¯åŠ¨è„šæœ¬
- `hub/scripts/test_hub.sh` - æµ‹è¯•è„šæœ¬
- `hub/requirements.txt` - Hubç«¯ä¾èµ–
- `hub/README.md` - Hubç«¯æ–‡æ¡£

#### é…ç½®å˜æ›´
- **è·¯å¾„**: `config.yaml` â†’ `hub/config/config.yaml`
- **ç»“æ„**: é‡æ„ä¸ºhub-centricé…ç½®ç»“æ„
- **å†…å®¹**: æ·»åŠ hubä¸“ç”¨é…ç½®é¡¹

#### å¯åŠ¨æ–¹å¼
- **åŸæ–¹å¼**: `python server.py`
- **æ–°æ–¹å¼**: `bash hub/scripts/start_hub.sh` æˆ– `python hub/src/main.py`

### 2. å®¢æˆ·ç«¯çŠ¶æ€

å®¢æˆ·ç«¯å·²ç»ç‹¬ç«‹ï¼Œæ— éœ€å˜æ›´ã€‚

### 3. æ ¹ç›®å½•å˜æ›´

#### æ›´æ–°æ–‡ä»¶
- `README.md` - æ›´æ–°ä¸ºå¤šé¡¹ç›®ç»“æ„è¯´æ˜
- `docs/` - æ·»åŠ é‡æ„æ–‡æ¡£

#### ç§»é™¤æ–‡ä»¶ï¼ˆå»ºè®®ï¼‰
- æ ¹ç›®å½•çš„é‡å¤æ–‡ä»¶å¯åœ¨åˆå¹¶åæ¸…ç†ï¼š
  - `server.py`
  - `config.yaml`
  - `src/` (Hubç«¯ç›¸å…³)
  - é‡å¤çš„æµ‹è¯•æ–‡ä»¶

## âœ… é‡æ„éªŒè¯

### 1. Hubç«¯éªŒè¯

```bash
cd hub
bash scripts/test_hub.sh    # æµ‹è¯•é€šè¿‡
bash scripts/start_hub.sh   # å¯åŠ¨æ­£å¸¸
```

### 2. å®¢æˆ·ç«¯éªŒè¯

```bash
cd client
bash scripts/test_client.sh  # æµ‹è¯•é€šè¿‡
bash scripts/install_client.sh # éƒ¨ç½²æ­£å¸¸
```

### 3. ç‹¬ç«‹æ€§éªŒè¯

- Hubç«¯å¯ä»¥ç‹¬ç«‹è¿è¡Œå’Œéƒ¨ç½²
- å®¢æˆ·ç«¯å¯ä»¥ç‹¬ç«‹è¿è¡Œå’Œéƒ¨ç½²
- é…ç½®æ–‡ä»¶å®Œå…¨åˆ†ç¦»
- ä¾èµ–å…³ç³»æ¸…æ™°

## ğŸ¯ é‡æ„ä¼˜åŠ¿

### 1. **æ¸…æ™°åˆ†ç¦»**
- Hubç«¯å’Œå®¢æˆ·ç«¯èŒè´£æ˜ç¡®
- ä»£ç ä¸ç›¸äº’ä¾èµ–
- é…ç½®æ–‡ä»¶ç‹¬ç«‹

### 2. **ç‹¬ç«‹ç»´æŠ¤**
- å¯ä»¥ç‹¬ç«‹å¼€å‘æ–°åŠŸèƒ½
- å¯ä»¥ç‹¬ç«‹å‡çº§éƒ¨ç½²
- ç‰ˆæœ¬æ§åˆ¶æ›´çµæ´»

### 3. **æ˜“äºéƒ¨ç½²**
- æ¯ä¸ªé¡¹ç›®éƒ½æœ‰å®Œæ•´çš„éƒ¨ç½²è„šæœ¬
- é…ç½®æ–‡ä»¶æ¸…æ™°æ˜“æ‡‚
- æ”¯æŒè‡ªåŠ¨åŒ–éƒ¨ç½²

### 4. **æ‰©å±•æ€§**
- å¯ä»¥è½»æ¾æ·»åŠ æ–°çš„å®¢æˆ·ç«¯
- å¯ä»¥å¼€å‘å¤šç§ç±»å‹çš„Hubç«¯
- æ”¯æŒæ’ä»¶åŒ–æ¶æ„

## ğŸ“‹ åç»­å»ºè®®

### 1. åˆå¹¶ä¸»åˆ†æ”¯
```bash
git checkout master
git merge feature/hub-refactor
git push origin master
```

### 2. æ¸…ç†æ ¹ç›®å½•
ç§»é™¤é‡å¤æ–‡ä»¶ï¼Œä¿ç•™æ¸…æ™°çš„é¡¹ç›®ç»“æ„ã€‚

### 3. ç‰ˆæœ¬ç®¡ç†
ä¸ºHubç«¯å’Œå®¢æˆ·ç«¯åˆ†åˆ«å»ºç«‹ç‰ˆæœ¬ç®¡ç†ç­–ç•¥ã€‚

### 4. CI/CD
ä¸ºä¸¤ä¸ªé¡¹ç›®å»ºç«‹ç‹¬ç«‹çš„CI/CDæµæ°´çº¿ã€‚

## ğŸš€ éƒ¨ç½²æŒ‡å¯¼

### Hubç«¯éƒ¨ç½²
```bash
# æ‰“åŒ…
tar -czf hub-1.0.0.tar.gz hub/

# éƒ¨ç½²åˆ°æœåŠ¡å™¨
scp hub-1.0.0.tar.gz server:~/
ssh server
tar -xzf hub-1.0.0.tar.gz
cd hub
pip install -r requirements.txt
bash scripts/test_hub.sh
bash scripts/start_hub.sh
```

### å®¢æˆ·ç«¯éƒ¨ç½²
```bash
# æ‰“åŒ…
cd client && bash package.sh

# éƒ¨ç½²åˆ°å®¢æˆ·ç«¯
scp databorder-client-1.0.0.tar.gz client:~/
ssh client
tar -xzf databorder-client-1.0.0.tar.gz
cd databorder-client-1.0.0
pip install -r requirements.txt
sudo bash scripts/install_client.sh --setup-crontab
```

---

**é‡æ„å®Œæˆæ—¶é—´**: 2025-02-04  
**é‡æ„çŠ¶æ€**: âœ… å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**: âœ… é€šè¿‡  
**éƒ¨ç½²çŠ¶æ€**: âœ… å°±ç»ª